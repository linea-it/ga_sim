<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to ga_sim’s documentation! &mdash; ga_sim 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> ga_sim
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to ga_sim’s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">ga_sim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Welcome to ga_sim’s documentation!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-ga_sim.ga_sim">
<span id="welcome-to-ga-sim-s-documentation"></span><h1>Welcome to ga_sim’s documentation!<a class="headerlink" href="#module-ga_sim.ga_sim" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.IMF_">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">IMF_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">author</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.IMF_" title="Permalink to this definition"></a></dt>
<dd><p>Defines dictionary for Kroupa and Salpeter initial mass functions.</p>
<p>The code below simulates stars using a Kroupa or Salpeter IMF,
and an exponential radius for the 2D distribution of stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>author</strong> (<em>str</em>) – The name of the initial mass function (IMF)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dict with the alpha values and mass breaks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.apply_err">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">apply_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.apply_err" title="Permalink to this definition"></a></dt>
<dd><p>This function returns magnitude errors for the ‘mag’ variable
based on mag_table and err_table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag</strong> (<em>list</em>) – The list of magnitudes to be calculated</p></li>
<li><p><strong>mag_table</strong> (<em>list</em>) – List of magnitudes</p></li>
<li><p><strong>err_table</strong> (<em>List</em>) – List of magnitude errors (1-sigma) respective to mag_table</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of magnitude errors following Normal distribution with
1-sigma error as informed</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.clean_input_cat">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">clean_input_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.clean_input_cat" title="Permalink to this definition"></a></dt>
<dd><p>This function removes all the stars that resides in the same ipix with
nside = nside. This is done to simulate the features of real catalogs based on
detections from SExtractor, where objects very close to each other are
interpreted as a single object. That is specially significant to
stellar clusters, where the stellar crowding in images creates a single
object in cluster’s center, but many star in the periphery.
This function calculates the counts in each ipix with nside (usually &gt; 2 ** 15)
and removes ALL of stars that resides in the same pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – Name of input file.</p></li>
<li><p><strong>ra_str</strong> (<em>str</em>) – Label for RA coordinate.</p></li>
<li><p><strong>dec_str</strong> (<em>str</em>) – Label for DEC coordinate.</p></li>
<li><p><strong>nside</strong> (<em>int</em>) – Nside to be populated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.clean_input_cat_dist">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">clean_input_cat_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist_arcsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.clean_input_cat_dist" title="Permalink to this definition"></a></dt>
<dd><p>This function removes stars closer than max_dist_arcsec. That is specially significant to
stellar clusters, where the stellar crowding in images creates a single
object in cluster’s center, but many star in the periphery.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – Name of input file.</p></li>
<li><p><strong>ra_str</strong> (<em>str</em>) – Label for RA coordinate.</p></li>
<li><p><strong>dec_str</strong> (<em>str</em>) – Label for DEC coordinate.</p></li>
<li><p><strong>max_dist_arcsec</strong> (<em>float</em>) – Stars closer than this par will be removed. Units: arcsec.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.clus_file_results">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">clus_file_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_clus_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objects_filepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.clus_file_results" title="Permalink to this definition"></a></dt>
<dd><p>This function uses the join command to join a file with initial features
of the simulated clusters to a file with number of stars and absolute
magnitude since the last file is created after the simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_path</strong> (<em>str</em>) – Path to final results file.</p></li>
<li><p><strong>out_file</strong> (<em>str</em>) – Name of final results file.</p></li>
<li><p><strong>sim_clus_feat</strong> (<em>str</em>) – Name of file with initial features of clusters.</p></li>
<li><p><strong>objects_filepath</strong> (<em>str</em>) – Name of file with n_stars and absolute magnitude.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.d_star_real_cat">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">d_star_real_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hpx_ftp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ftp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.d_star_real_cat" title="Permalink to this definition"></a></dt>
<dd><p>This function distributes the set of stars with lenght
in a catalog based on the set of hpx_ftp (healpix footprint).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hpx_ftp</strong> (<em>list</em>) – The set of ipixels in the footprint</p></li>
<li><p><strong>length</strong> (<em>int</em>) – Total amount of stars in the real catalog</p></li>
<li><p><strong>nside3</strong> (<em>int</em>) – Nside HealPix to granullarity of the stellar positions.</p></li>
<li><p><strong>nside_ftp</strong> (<em>int</em>) – Nside of the footprint map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ra_mw_stars, dec_mw_stars</strong> – The position of the stars in the catalog (degrees)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.dist_ang">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">dist_ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_ref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.dist_ang" title="Permalink to this definition"></a></dt>
<dd><p>Calculated the angular distance between (ra1, dec1) and (ra_ref, dec_ref)
ra-dec in degrees
ra1-dec1 can be arrays
ra_ref-dec_ref are scalars
output is in degrees
:param ra1: Positions in the sky
:type ra1: lists or arrays
:param dec1: Positions in the sky
:type dec1: lists or arrays
:param ra_ref: Reference position in the sky
:type ra_ref: floats
:param dec_ref: Reference position in the sky
:type dec_ref: floats</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of floats with the angular distance in degrees of the
first couple of inputs to the position of reference.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.download_iso">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">download_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phot_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.download_iso" title="Permalink to this definition"></a></dt>
<dd><p>Submit a request of an isochrone from PADOVA schema, download the file
requested and uses as an input file to the stellar population of clusters.
Good reference to Fe/H and M/H and Z:
<a class="reference external" href="https://www.aanda.org/articles/aa/full_html/2014/03/aa20956-12/aa20956-12.html">https://www.aanda.org/articles/aa/full_html/2014/03/aa20956-12/aa20956-12.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>version</strong> (<em>str</em>) – Version of PADOVA/PARSEC isochrones (‘3.4’, ‘3.5’ or ‘3.6’)</p></li>
<li><p><strong>phot_system</strong> (<em>str</em>) – Photometric system of isochrones. For DES uses ‘decam’.</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Amount of metals in mass. Z_sun = 0.019.</p></li>
<li><p><strong>age</strong> (<em>float</em>) – Age of isochrone in years (not log age).</p></li>
<li><p><strong>av_ext</strong> (<em>float</em>) – Extinction in V band. Usually 0.000.</p></li>
<li><p><strong>out_file</strong> (<em>str</em>) – Name of the output file, which is written as
output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.exp_prof">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">exp_prof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rexp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.exp_prof" title="Permalink to this definition"></a></dt>
<dd><p>This function distributes stars radially following an exponential
density profile. This function does not distribute stars into 3D,
only in 1-D, which is complemented in additional code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_stars</strong> (<em>int</em>) – Total number counts.</p></li>
<li><p><strong>rexp</strong> (<em>float</em>) – Scale radius of cluster, in degrees or parsecs.</p></li>
<li><p><strong>max_length</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum distance of star in scale radius, by default 10</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius of stars following exponential density profile.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.export_results">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">export_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proc_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.export_results" title="Permalink to this definition"></a></dt>
<dd><p>This function exports the results of the run to a directory called proc_dir,
creating a subfolder with number following the last process in that folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>proc_dir</strong> (<em>str</em>) – Directory where the subfolder with all the results will be copied to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.faker">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">faker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_stars_cmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_bin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IMF_author</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rexp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag1_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err1_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err2_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_iso</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_ref_comp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_mag_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_mag_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.faker" title="Permalink to this definition"></a></dt>
<dd><p>Creates an array with positions, magnitudes, magnitude errors and magnitude
uncertainties for the simulated stars in two bands.</p>
<p>The stars belong to a simple
stellar population and they are spatially distributed following an exponential profile.
The code firstly simulates the stars in the CMDs and finally simulates only the
companions of the binaries (it does not matter how massive the companions are) to
join to the number of points in the CMD.
Bear in mind these quantities (definitions):
N_stars_cmd = number of stars seen in the CMD. The binaries are seen as a single star.
N_stars_single = amount of stars that are single stars.
N_stars_bin = amount of stars that are binaries in the CMD. For each of these kind of
stars, a companion should be calculated later.
Completeness function is a step function modified where the params are a magnitude of
reference and its completeness, and the completeness at maximum magnitude. The complete-
ness function is equal to unity to magnitudes brighter than reference magnitude, and
decreases linearly to the maximum magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_stars_cmd</strong> (<em>int</em>) – Points in simulated cmd given the limiting magnitude. Some of this stars are single,
some of the are binaries. This amount obeys the following relation:
N_stars_cmd = N_stars_single + N_stars_bin, where N_stars_single are the single stars
in the cmd and N_stars_bin are the points in CMD that are binaries. A single star in
each system are accounted for. In this case, the total amount of stars simulated is
N_stars_single + 2 * N_stars_bin</p></li>
<li><p><strong>frac_bin</strong> (<em>float</em><em> (</em><em>0-1</em><em>)</em>) – Fraction of binaries. This is the total amount of stars in the CMD that belongs to a
binary system (= 2 * N_stars_bin / total amount of stars).</p></li>
<li><p><strong>IMF_author</strong> (<em>str</em>) – Name of the IMF (see function above)</p></li>
<li><p><strong>x0</strong> (<em>float</em><em> (</em><em>degrees</em><em>)</em>) – RA position of the center of cluster</p></li>
<li><p><strong>y0</strong> (<em>float</em><em>(</em><em>degrees</em><em>)</em>) – DEC position of the center of cluster</p></li>
<li><p><strong>rexp</strong> (<em>float</em><em> (</em><em>degrees</em><em>)</em>) – Exponential radii of the cluster following the exponential law of density:
N = A * exp(-r/rexp)</p></li>
<li><p><strong>ell</strong> (<em>float</em>) – Ellipticity of the cluster (ell_=sqrt((a^2-b^2)/(a^2)))</p></li>
<li><p><strong>pa</strong> (<em>float</em>) – Positional angle (from North to East), in degrees</p></li>
<li><p><strong>dist</strong> (<em>float</em>) – Distance to the cluster in parsecs</p></li>
<li><p><strong>hpx</strong> (<em>int</em>) – Pixel where the cluster resides (nested)</p></li>
<li><p><strong>cmin</strong> (<em>float</em>) – Minimum color.</p></li>
<li><p><strong>cmax</strong> (<em>float</em>) – Maximum color.</p></li>
<li><p><strong>mmin</strong> (<em>float</em>) – Minimum magnitude.</p></li>
<li><p><strong>mmax</strong> (<em>float</em>) – Maximum magnitude.</p></li>
<li><p><strong>mag1</strong> (<em>list</em>) – List of magnitudes acoording error.</p></li>
<li><p><strong>err1</strong> (<em>list</em>) – List of errors in bluer magnitude.</p></li>
<li><p><strong>err2</strong> (<em>list</em>) – List of errors in redder magnitude.</p></li>
<li><p><strong>file_iso</strong> (<em>str</em>) – Name of file with data from isochrone.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Folder where the files will be written.</p></li>
<li><p><strong>mag_ref_comp</strong> (<em>float</em>) – Magnitude of reference where the completeness is equal to comp_mag_ref.</p></li>
<li><p><strong>comp_mag_ref</strong> (<em>float</em>) – Completeness (usually unity) at mag_ref_comp.</p></li>
<li><p><strong>comp_mag_max</strong> (<em>float</em>) – Completeness (value between 0. and 1.) at the maximum magnitude.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.faker_bin">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">faker_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_bin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IMF_author</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.faker_bin" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fraction of binaries in the simulated clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_bin</strong> (<em>float</em>) – The amount of binaries. Definition: N is the total amount of
stars (take care to count a system of a binary as two stars),
and B is the amount of stars in binary systems.
so bin_frac = B / N</p></li>
<li><p><strong>IMF_author</strong> (<em>str</em>) – Name of the IMF (see function above)</p></li>
<li><p><strong>file_in</strong> (<em>str</em>) – The name of the file with star’s masses and magnitudes</p></li>
<li><p><strong>dist</strong> (<em>float</em>) – Distance cluster-observer in parsecs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>binaries[</strong> (<em>,0]</em>) – a list of magnitudes of the binaries in the first band</p></li>
<li><p><strong>binaries[</strong> (<em>,1]</em>) – a list of magnitudes of the binaries in the second band</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.gen_clus_file">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">gen_clus_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_extract</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mM_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mM_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_rexp_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_rexp_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_mass_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_mass_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pa_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pa_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.gen_clus_file" title="Permalink to this definition"></a></dt>
<dd><p>This function generates the file with features of simulated clusters,
based on numerical simulations within the range of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_min</strong> (<em>float</em>) – Minimum value of RA, in degrees.</p></li>
<li><p><strong>ra_max</strong> (<em>float</em>) – Maximum value of RA, in degrees.</p></li>
<li><p><strong>dec_min</strong> (<em>_type_</em>) – Minimum value of DEC, in degrees.</p></li>
<li><p><strong>dec_max</strong> (<em>_type_</em>) – Maximum value of DEC, in degrees.</p></li>
<li><p><strong>nside_ini</strong> (<em>int</em>) – Nside where the clusters simulated will reside (in the center of ipix).</p></li>
<li><p><strong>border_extract</strong> (<em>float</em>) – The angular border (in degrees) where the clusters will not be simulated.</p></li>
<li><p><strong>mM_min</strong> (<em>float</em>) – Minimum value for distance modulus (in magnitudes).</p></li>
<li><p><strong>mM_max</strong> (<em>_type_</em>) – Maximum value for distance modulus (in magnitudes).</p></li>
<li><p><strong>log10_rexp_min</strong> (<em>float</em>) – Minimum value for log_10 of exponential radius, in parsecs.</p></li>
<li><p><strong>log10_rexp_max</strong> (<em>float</em>) – Maximum value for log_10 of exponential radius, in parsecs.</p></li>
<li><p><strong>log10_mass_min</strong> (<em>float</em>) – Minimum value for log_10 of visible mass (mass of stars that are in
the range of magnitudes), in Msun.</p></li>
<li><p><strong>log10_mass_max</strong> (<em>float</em>) – Maximum value for log_10 of visible mass (mass of stars that are in
the range of magnitudes), in Msun.</p></li>
<li><p><strong>ell_min</strong> (<em>float</em>) – Minimum value for ellipticity (b-a)/a.</p></li>
<li><p><strong>ell_max</strong> (<em>float</em>) – Maximum value for ellipticity (b-a)/a.</p></li>
<li><p><strong>pa_min</strong> (<em>float</em>) – Minimum value for positional angle (oriented to ), in degrees.</p></li>
<li><p><strong>pa_max</strong> (<em>float</em>) – Maximum value for positional angle (oriented to ), in degrees.</p></li>
<li><p><strong>results_path</strong> (<em>str</em>) – Path where the final file is written.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RA_pix, DEC_pix, r_exp, ell, pa, dist, mass, mM, hp_sample_un
Position of the center of ipix, exponential radius in parsecs,
ellipticity. positional angle, distance in parsecs, mass in
Sun masses, distance modulus, and list of ipix sampled.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.get_av">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">get_av</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gal_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gal_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sgp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.get_av" title="Permalink to this definition"></a></dt>
<dd><p>Return extinction (A) in V band based on l, b position. Rv is defined as
a constant and equal to 3.1.</p>
<p>return the extinction in the V band since the catalog used for detection is
extinction free. In the future, may be read the magnitude already corrected
by extinction in the VAC or catalog.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gal_l</strong> (<em>list</em>) – Galactic longitude of the objects (degrees)</p></li>
<li><p><strong>gal_b</strong> (<em>list</em>) – Galactic latitude of the objects (degrees)</p></li>
<li><p><strong>ngp</strong> (<em>array</em><em> or </em><em>map</em>) – Northern Galactic reddening map.</p></li>
<li><p><strong>sgp</strong> (<em>array</em><em> or </em><em>map</em>) – Southern Galactic reddening map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>av</strong> – a list of Galactic extinction in the V band to each position</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.join_cat">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">join_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_sample_un</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">survey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAG_G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAG_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAGERR_G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAGERR_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('results/fake_clus')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('results')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.join_cat" title="Permalink to this definition"></a></dt>
<dd><p>Join the catalog of real stars with random position
and all the small catalogs of simulated clusters into a single one.</p>
<p>There is a cut in the coord limits implemented below.
Only global parameters are needed (see its description above)
and the code is intended to write a single fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_min</strong> (<em>float</em>) – Minimum right ascention in degrees</p></li>
<li><p><strong>ra_max</strong> (<em>float</em>) – Maximum right ascention in degrees</p></li>
<li><p><strong>dec_min</strong> (<em>float</em>) – Minimum declination in degrees.</p></li>
<li><p><strong>dec_max</strong> (<em>float</em>) – Maximum declination in degrees.</p></li>
<li><p><strong>hp_sample_un</strong> (<em>list</em>) – List of footprint healpix</p></li>
<li><p><strong>survey</strong> (<em>str</em>) – THe name of survey.</p></li>
<li><p><strong>RA</strong> (<em>array-like</em>) – Right ascention of the stars, in degrees.</p></li>
<li><p><strong>DEC</strong> (<em>array-like</em>) – Declination of stars in degrees.</p></li>
<li><p><strong>MAG_G</strong> (<em>array-like</em>) – Bluer magnitude of stars.</p></li>
<li><p><strong>MAG_R</strong> (<em>array-like</em>) – Redder magnitude of stars.</p></li>
<li><p><strong>MAGERR_G</strong> (<em>array-like</em>) – Error of stellar measurements for the first band.</p></li>
<li><p><strong>MAGERR_R</strong> (<em>array-like</em>) – Error of stellar measurements for the second band.</p></li>
<li><p><strong>nside_ini</strong> (<em>float</em>) – Nside of hp_sample_un.</p></li>
<li><p><strong>mmax</strong> (<em>float</em>) – Maximum magnitude of stars.</p></li>
<li><p><strong>mmin</strong> (<em>float</em>) – Minimum magnitude of stars.</p></li>
<li><p><strong>cmin</strong> (<em>float</em>) – Minimum color of stars.</p></li>
<li><p><strong>cmax</strong> (<em>float</em>) – Maximum color of stars.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.join_cats_clean">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">join_cats_clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ipix_cats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.join_cats_clean" title="Permalink to this definition"></a></dt>
<dd><p>This function writes a single Fits file catalog gathering
data read in all the ipix_cats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ipix_cats</strong> (<em>list</em>) – List of ipix FITS files catalogs.</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – File name with all data from ipix cats.</p></li>
<li><p><strong>ra_str</strong> (<em>str</em>) – Label of RA coordinate.</p></li>
<li><p><strong>dec_str</strong> (<em>str</em>) – Label of DEC coordinate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.king_prof">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">king_prof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.king_prof" title="Permalink to this definition"></a></dt>
<dd><p>This function distributes stars in a King profile, the number-density profile
most applied to globular clusters. The final array is the stars distributes along
projected radii.
Reference:
<a class="reference external" href="https://www.aanda.org/articles/aa/full/2008/03/aa8616-07/aa8616-07.html">https://www.aanda.org/articles/aa/full/2008/03/aa8616-07/aa8616-07.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_stars</strong> (<em>int</em>) – Total star counts.</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – Core radius, not specified units.</p></li>
<li><p><strong>rt</strong> (<em>float</em>) – Spherical tidal radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radial distribution of stars.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.make_footprint">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">make_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ftp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('results')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.make_footprint" title="Permalink to this definition"></a></dt>
<dd><p>Creates a partial HealPix map based on the area selected,
with nside = nside_ftp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_min</strong> (<em>float</em><em> (</em><em>global</em><em>)</em>) – Limits in ra and dec (degrees)</p></li>
<li><p><strong>ra_max</strong> (<em>float</em><em> (</em><em>global</em><em>)</em>) – Limits in ra and dec (degrees)</p></li>
<li><p><strong>dec_min</strong> (<em>float</em><em> (</em><em>global</em><em>)</em>) – Limits in ra and dec (degrees)</p></li>
<li><p><strong>dec_max</strong> (<em>float</em><em> (</em><em>global</em><em>)</em>) – Limits in ra and dec (degrees)</p></li>
<li><p><strong>nside_ftp</strong> (<em>int</em><em> (</em><em>global</em><em>)</em>) – Nside of the footprint map.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of ipixels in the area selected (inclusive=False)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.radec2GCdist">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">radec2GCdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_kpc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.radec2GCdist" title="Permalink to this definition"></a></dt>
<dd><p>Return Galactocentric distance from ra, dec, D_sun_kpc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra</strong> (<em>float</em><em> or </em><em>list</em>) – Coordinates of the objects (in deg)</p></li>
<li><p><strong>dec</strong> (<em>float</em><em> or </em><em>list</em>) – Coordinates of the objects (in deg)</p></li>
<li><p><strong>dist_kpc</strong> (<em>float</em><em> or </em><em>list</em>) – Distance in kpc of the objects</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the Galactocentric distance to the object[s]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.read_cat">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">read_cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tablename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AG_AV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AR_AV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sgp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpx_ftp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ftp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.read_cat" title="Permalink to this definition"></a></dt>
<dd><p>Read catalog from LIneA data base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tablename</strong> (<em>str</em>) – Name of FITS file.</p></li>
<li><p><strong>ra_min</strong> (<em>float</em>) – Minimum value of RA in degrees.</p></li>
<li><p><strong>ra_max</strong> (<em>float</em>) – Maximum value of RA in degrees.</p></li>
<li><p><strong>dec_min</strong> (<em>float</em>) – Minimum value of DEC in degrees.</p></li>
<li><p><strong>dec_max</strong> (<em>float</em>) – Maximum value of RA in degrees.</p></li>
<li><p><strong>mmin</strong> (<em>float</em>) – Minimum value of magnitude.</p></li>
<li><p><strong>mmax</strong> (<em>float</em>) – Maximum value of magnitude.</p></li>
<li><p><strong>cmin</strong> (<em>float</em>) – Minimum value of color.</p></li>
<li><p><strong>cmax</strong> (<em>float</em>) – Maximum value of color.</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output file.</p></li>
<li><p><strong>AG_AV</strong> (<em>float</em>) – Relation of extinction in g band over extinction in V band.</p></li>
<li><p><strong>AR_AV</strong> (<em>_type_</em>) – Relation of extinction in r band over extinction in V band.</p></li>
<li><p><strong>ngp</strong> (<em>array-like</em>) – Map of reddening for Northern Galactic Hemisphere.</p></li>
<li><p><strong>sgp</strong> (<em>array-like</em>) – Map of reddening for Southern Galactic Hemisphere.</p></li>
<li><p><strong>results_path</strong> (<em>str</em>) – Path where the results will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RA, DEC, MAG_G, MAGERR_G, MAG_R, MAGERR_R
Contents of table where magnitudes are free-extnction (top of Galaxy).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.read_error">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">read_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_add_mag1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_add_mag2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.read_error" title="Permalink to this definition"></a></dt>
<dd><p>This function reads the photometric error of survey.
Values are added to simulate realistic photometric errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<em>str</em>) – Name of file with errors.</p></li>
<li><p><strong>to_add_mag1</strong> (<em>float</em>) – Magnitude error to be added to mag1.</p></li>
<li><p><strong>to_add_mag2</strong> (<em>float</em>) – Magnitude error to be added to mag2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of magnitudes and errors in band 1 and 2.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.remove_close_stars">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">remove_close_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PSF_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PSF_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.remove_close_stars" title="Permalink to this definition"></a></dt>
<dd><p>This function removes the stars closer than PSF_factor * PSF_size
This is an observational bias of the DES since the photometric pipeline
is set to join regions closer than an specific distance.
In this sense, if many objects are crowded in a small area,
the pipeline joins the detections into a single object.</p>
<p>This function may be improved to run in parallel using many ipixels
since it takes too long to check and remove stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_cat</strong> (<em>str</em>) – The file with the information of the objects</p></li>
<li><p><strong>output_cat</strong> (<em>str</em>) – The output file to be written with the stars that survived the test.</p></li>
<li><p><strong>PSF_factor</strong> (<em>float</em>) – A factor to multiply the PSF size. The result is the minimal distance
between two objects to be detected as two objects. If the distance
is less than PSF_factor * PSF_size, none of the objects survives.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.snr_estimate">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">snr_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RA__</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DEC__</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G__</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GR__</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PIX_sim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mM_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_circle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin_annulus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout_annulus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.snr_estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the SNR (Signal to Noise Ratio) of the simulated cluster in density-number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RA</strong> (<em>lists</em>) – The coordinates of the stars in the catalog</p></li>
<li><p><strong>DEC</strong> (<em>lists</em>) – The coordinates of the stars in the catalog</p></li>
<li><p><strong>G</strong> (<em>lists</em>) – Apparent magnitude in g band and g-r color of the stars.</p></li>
<li><p><strong>GR</strong> (<em>lists</em>) – Apparent magnitude in g band and g-r color of the stars.</p></li>
<li><p><strong>PIX_sim</strong> (<em>int</em>) – The pixel where the simulated cluster resided (nside=nside1)
Nest=True.</p></li>
<li><p><strong>nside1</strong> (<em>int</em>) – Nside of the pixelization of the sky reagarding the distribution of simulated clusters.</p></li>
<li><p><strong>mM</strong> (<em>float</em>) – Modulus distance of the simulated cluster</p></li>
<li><p><strong>inner_circle</strong> (<em>float</em>) – Radius of the inner circle (in deg) where the signal is estimated</p></li>
<li><p><strong>rin_annulus</strong> (<em>float</em>) – Inner radius where the noise is estimated (in deg)</p></li>
<li><p><strong>rout_annulus</strong> (<em>float</em>) – Outer radius where the noise is estimated (in deg)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The SNR estimated following the SNR = N_inner / sqrt(N_outter_circle)
where N_inner is the amount of stars in the inner_circle
and N_outter_circle is the star counts in the outter circle
normalized by the area of the inner_circle.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.split_files">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">split_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.split_files" title="Permalink to this definition"></a></dt>
<dd><p>This function split a main file into small catalogs, based on
HealPix ipix files, with nside=nside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<em>str</em>) – Input file.</p></li>
<li><p><strong>ra_str</strong> (<em>str</em>) – Label of RA coordinate.</p></li>
<li><p><strong>dec_str</strong> (<em>str</em>) – Label of DEC coordinate.</p></li>
<li><p><strong>nside</strong> (<em>int</em>) – Nside to split small catalogs.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to output files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name and path of output files.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.unc">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">unc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.unc" title="Permalink to this definition"></a></dt>
<dd><p>Interpolates the uncertainty in magnitude for a specific magnitude
using magnitude and error from table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag</strong> (<em>float</em><em> or </em><em>list</em>) – The magnitude to be interpolated</p></li>
<li><p><strong>mag_table</strong> (<em>list</em>) – List of magnitudes in table</p></li>
<li><p><strong>err_table</strong> (<em>list</em>) – List of magnitude errors in table</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>err_interp</strong> – Magnitudes interpolated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ga_sim.ga_sim.write_sim_clus_features">
<span class="sig-prename descclassname"><span class="pre">ga_sim.ga_sim.</span></span><span class="sig-name descname"><span class="pre">write_sim_clus_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mockcat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mockcat_clean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_sample_un</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr_inner_circle_arcmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr_rin_annulus_arcmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr_rout_annulus_arcmin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ga_sim.ga_sim.write_sim_clus_features" title="Permalink to this definition"></a></dt>
<dd><p>Write a few features of the clusters in a file called ‘N_stars,dat’.
The columns of the file are:
- the ipix of the cluster that serves as an ID (hp_sample_un[j]),
- star counts (len(RA[cond_clus])),
- absolute magnitude in V band (M_abs_V), and
- signal-to-noise ratio (SNR).
- star counts in the clean catalog (removing stars too close to each other),
- absolute magnitude in V band in the clean catalog, and
- signal-to-noise ratio in the clean catalog (SNR_clean).
Only global parameters are needed (see its description in the first cells).
The file must be written after the simulation because the absolute
magnitude of the cluster and the number of stars are estimated after
the simulation. The absolute magnitude depends strongly on the brightest
stars and the star counts may vary in a few counts for instance
for two clusters with the same mass (stars are a numerical realization
within an IMF).</p>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Adriano Pieres.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>